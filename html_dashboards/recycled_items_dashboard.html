<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recycled Items Sales Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }



        .nav-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e9ecef;
        }

        .nav-bar a {
            color: #3498db;
            text-decoration: none;
            margin-right: 20px;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-bar a:hover {
            color: #2980b9;
        }

        .nav-bar a.active {
            color: #2c3e50;
            font-weight: 600;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }

        .stat-card h3 {
            color: #2c3e50;
            font-size: 0.9rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }

        .table-container {
            padding: 20px;
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .table-header h2 {
            color: #2c3e50;
            font-size: 1.5rem;
        }

        .controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .filter-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.9rem;
        }

        .filter-group select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 0.9rem;
            background: white;
            min-width: 150px;
            transition: border-color 0.3s ease;
        }

        .filter-group select:focus {
            outline: none;
            border-color: #3498db;
        }

        .filter-status {
            background: #d4edda;
            color: #155724;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-left: auto;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 15px;
            width: 95%;
            max-width: 1400px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }

        .close {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.3s;
        }

        .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 30px;
        }

        .modal-footer {
            background: #f8f9fa;
            padding: 20px 30px;
            border-radius: 0 0 15px 15px;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        /* Entry Details */
        .entry-details {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
        }

        .form-group label {
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select {
            padding: 10px 12px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
        }

        /* Items Table */
        .items-table-container {
            margin-top: 20px;
        }

        .items-table-container h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .items-table th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            border: none;
        }

        .items-table th:last-child {
            text-align: center;
        }

        .items-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #ecf0f1;
            font-size: 0.9rem;
            vertical-align: middle;
        }

        .items-table td:first-child {
            font-weight: 500;
            color: #2c3e50;
        }

        .items-table td:last-child {
            text-align: center;
        }

        .items-table input[type="number"] {
            width: 120px;
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 0.9rem;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            text-align: center;
            transition: border-color 0.3s;
        }

        .items-table input[type="number"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .items-table input[type="number"]::placeholder {
            color: #bdc3c7;
        }

        .items-table tbody tr:hover {
            background-color: #f8f9fa;
        }

        @media (max-width: 768px) {
            .entry-form-layout {
                grid-template-columns: 1fr;
            }
            
            .entry-details {
                flex-direction: column;
            }
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
            border: none;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th:first-child {
            text-align: left;
            padding-left: 20px;
        }

        td {
            padding: 12px 10px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
            font-size: 0.9rem;
        }

        td:first-child {
            text-align: left;
            padding-left: 20px;
            font-weight: 500;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .number-cell {
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .total-row {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            font-weight: bold;
        }

        .total-row td {
            border-bottom: none;
        }

        .category-group {
            background: #ecf0f1;
            font-weight: bold;
            color: #2c3e50;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #7f8c8d;
        }

        .error {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 20px;
        }

        @media (max-width: 768px) {
            .stats-bar {
                grid-template-columns: 1fr;
            }
            
            .table-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .controls {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔄 Recycled Items Sales Dashboard</h1>
            <p>Daily tracking of recycled materials sales and inventory</p>
        </div>

        <div class="nav-bar">
            <a href="index.html">🏠 Home</a>
            <a href="thai_truck_dashboard.html">🚛 Truck Analysis</a>
            <a href="recycled_items_dashboard.html" class="active">🔄 Recycled Items</a>
            <a href="sales_payment_dashboard.html">💰 Sales & Payments</a>
        </div>

        <div class="stats-bar">
            <div class="stat-card">
                <h3>Total Items Sold</h3>
                <div class="value" id="totalItems">0</div>
            </div>
            <div class="stat-card">
                <h3>Total Revenue</h3>
                <div class="value" id="totalRevenue">฿0</div>
            </div>
            <div class="stat-card">
                <h3>Active Categories</h3>
                <div class="value" id="activeCategories">0</div>
            </div>
            <div class="stat-card">
                <h3>Today's Date</h3>
                <div class="value" id="currentDate">-</div>
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">
                <h2>📊 Daily Sales Log</h2>
                <div class="controls">
                    <button class="btn btn-primary" onclick="openAddEntryModal()">📝 Add Daily Entry</button>
                    <button class="btn btn-success" onclick="exportToExcel()">📥 Export Excel</button>
                    <button class="btn btn-warning" onclick="calculateTotals()">🧮 Calculate Totals</button>
                </div>
            </div>

            <!-- Filter Controls -->
            <div class="filter-section">
                <div class="filter-group">
                    <label for="monthFilter">📅 Month:</label>
                    <select id="monthFilter" onchange="filterData()">
                        <option value="">All Months</option>
                        <option value="01">January</option>
                        <option value="02">February</option>
                        <option value="03">March</option>
                        <option value="04">April</option>
                        <option value="05">May</option>
                        <option value="06">June</option>
                        <option value="07">July</option>
                        <option value="08">August</option>
                        <option value="09">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="customerFilter">👤 Customer:</label>
                    <select id="customerFilter" onchange="filterData()">
                        <option value="">All Customers</option>
                        <option value="Factory A">Factory A</option>
                        <option value="Factory B">Factory B</option>
                        <option value="Factory C">Factory C</option>
                        <option value="Recycling Center 1">Recycling Center 1</option>
                        <option value="Recycling Center 2">Recycling Center 2</option>
                        <option value="Waste Management Co">Waste Management Co</option>
                    </select>
                </div>
                <div class="filter-group">
                    <button class="btn btn-secondary" onclick="clearFilters()">🔄 Clear Filters</button>
                </div>
            </div>

            <div id="tableContent">
                <div class="loading">Loading table...</div>
            </div>
        </div>

        <!-- Add Daily Entry Modal -->
        <div id="addEntryModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>📝 Add Daily Entry</h2>
                    <span class="close" onclick="closeAddEntryModal()">&times;</span>
                </div>
                
                <div class="modal-body">
                    <!-- Entry Details -->
                    <div class="entry-details">
                        <div class="form-group">
                            <label for="entryDate">📅 Date:</label>
                            <input type="datetime-local" id="entryDate" required>
                        </div>
                        <div class="form-group">
                            <label for="entryCustomer">👤 Customer:</label>
                            <select id="entryCustomer" required>
                                <option value="">Select Customer</option>
                                <option value="Factory A">Factory A</option>
                                <option value="Factory B">Factory B</option>
                                <option value="Factory C">Factory C</option>
                                <option value="Recycling Center 1">Recycling Center 1</option>
                                <option value="Recycling Center 2">Recycling Center 2</option>
                                <option value="Waste Management Co">Waste Management Co</option>
                            </select>
                        </div>
                    </div>

                    <!-- Items Table -->
                    <div class="items-table-container">
                        <h3>🔄 Recycled Items Entry</h3>
                        <table class="items-table">
                            <thead>
                                <tr>
                                    <th>Item Name</th>
                                    <th>Quantity</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ถุงพลาสติก (Plastic Bags)</td>
                                    <td><input type="number" id="plasticBags" name="plasticBags" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>ถุงกระสอบ (Sacks)</td>
                                    <td><input type="number" id="sacks" name="sacks" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>เหล็ก (Iron/Steel)</td>
                                    <td><input type="number" id="ironSteel" name="ironSteel" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>ถังเหล็ก (Metal Drums)</td>
                                    <td><input type="number" id="metalDrums" name="metalDrums" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>กระป๋องเหล็ก (Metal Cans)</td>
                                    <td><input type="number" id="metalCans" name="metalCans" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>ขวดแก้ว (Glass Bottles)</td>
                                    <td><input type="number" id="glassBottles" name="glassBottles" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>เป่าขาว (White Blow)</td>
                                    <td><input type="number" id="whiteBlow" name="whiteBlow" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>เป๋าใสขุ่น (Opaque Blow)</td>
                                    <td><input type="number" id="opaqueBlow" name="opaqueBlow" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>พลาสติกรวม (Mixed Plastics)</td>
                                    <td><input type="number" id="mixedPlastics" name="mixedPlastics" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>พลาสติกกรอบ (Brittle Plastics)</td>
                                    <td><input type="number" id="brittlePlastics" name="brittlePlastics" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>พลาสติกดำ (Black Plastics)</td>
                                    <td><input type="number" id="blackPlastics" name="blackPlastics" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>ขวดใสอัด (Compressed Clear Bottles)</td>
                                    <td><input type="number" id="compressedBottles" name="compressedBottles" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>กระป๋องอลูมิเนียม (Aluminum Cans)</td>
                                    <td><input type="number" id="aluminumCans" name="aluminumCans" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>สเตนเลส 202 (Stainless 202)</td>
                                    <td><input type="number" id="stainless202" name="stainless202" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>จิ๊บ (Jip)</td>
                                    <td><input type="number" id="jip" name="jip" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>อลูมิเนียม (Aluminum)</td>
                                    <td><input type="number" id="aluminum" name="aluminum" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>แบต (Batteries)</td>
                                    <td><input type="number" id="batteries" name="batteries" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>ลัง (Crates/Boxes)</td>
                                    <td><input type="number" id="crates" name="crates" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>ลังเบียร (Beer Crates)</td>
                                    <td><input type="number" id="beerCrates" name="beerCrates" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>น้ำมันพืชเก่า (Used Cooking Oil)</td>
                                    <td><input type="number" id="usedOil" name="usedOil" min="0" step="1" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td>ยางรถเก่า (Old Car Tires)</td>
                                    <td><input type="number" id="carTires" name="carTires" min="0" step="1" placeholder="0"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeAddEntryModal()">❌ Cancel</button>
                    <button class="btn btn-success" onclick="submitEntry()">✅ Submit Entry</button>
                </div>
            </div>
        </div>


    </div>

    <script>
        // Sample data structure based on your table
        const recycledItemsData = {
            headers: [
                "Date",
                "Customer",
                "ถุงพลาสติก (Plastic Bags)",
                "ถุงกระสอบ (Sacks)",
                "เหล็ก (Iron/Steel)",
                "ถังเหล็ก (Metal Drums)",
                "กระป๋องเหล็ก (Metal Cans)",
                "ขวดแก้ว (Glass Bottles)",
                "เป่าขาว (White Blow)",
                "เป๋าใสขุ่น (Opaque Blow)",
                "พลาสติกรวม (Mixed Plastics)",
                "พลาสติกกรอบ (Brittle Plastics)",
                "พลาสติกดำ (Black Plastics)",
                "ขวดใสอัด (Compressed Clear Bottles)",
                "กระป๋องอลูมิเนียม (Aluminum Cans)",
                "สเตนเลส 202 (Stainless 202)",
                "จิ๊บ (Jip)",
                "อลูมิเนียม (Aluminum)",
                "แบต (Batteries)",
                "ลัง (Crates/Boxes)",
                "ลังเบียร (Beer Crates)",
                "น้ำมันพืชเก่า (Used Cooking Oil)",
                "ยางรถเก่า (Old Car Tires)"
            ],
            sampleData: [
                {
                    date: "2024-01-15",
                    customer: "Factory A",
                    plasticBags: 75620,
                    sacks: 13870,
                    ironSteel: 4435,
                    metalDrums: 0,
                    metalCans: 5535,
                    glassBottles: 26150,
                    whiteBlow: 1545,
                    opaqueBlow: 935,
                    mixedPlastics: 6615,
                    brittlePlastics: 161,
                    blackPlastics: 1328,
                    compressedBottles: 11250,
                    aluminumCans: 395,
                    stainless202: 0,
                    jip: 0,
                    aluminum: 0,
                    batteries: 0,
                    crates: 0,
                    beerCrates: 0,
                    usedOil: 11,
                    carTires: 0
                },
                {
                    date: "2024-02-20",
                    customer: "Factory B",
                    plasticBags: 45230,
                    sacks: 8920,
                    ironSteel: 3120,
                    metalDrums: 150,
                    metalCans: 4230,
                    glassBottles: 18950,
                    whiteBlow: 980,
                    opaqueBlow: 650,
                    mixedPlastics: 4450,
                    brittlePlastics: 95,
                    blackPlastics: 890,
                    compressedBottles: 8750,
                    aluminumCans: 280,
                    stainless202: 25,
                    jip: 0,
                    aluminum: 45,
                    batteries: 12,
                    crates: 0,
                    beerCrates: 0,
                    usedOil: 8,
                    carTires: 0
                },
                {
                    date: "2024-03-10",
                    customer: "Recycling Center 1",
                    plasticBags: 67890,
                    sacks: 15670,
                    ironSteel: 5678,
                    metalDrums: 0,
                    metalCans: 6789,
                    glassBottles: 32450,
                    whiteBlow: 2345,
                    opaqueBlow: 1234,
                    mixedPlastics: 7890,
                    brittlePlastics: 234,
                    blackPlastics: 1678,
                    compressedBottles: 14560,
                    aluminumCans: 567,
                    stainless202: 0,
                    jip: 0,
                    aluminum: 0,
                    batteries: 0,
                    crates: 45,
                    beerCrates: 23,
                    usedOil: 15,
                    carTires: 0
                },
                {
                    date: "2024-04-05",
                    customer: "Waste Management Co",
                    plasticBags: 34560,
                    sacks: 7890,
                    ironSteel: 2345,
                    metalDrums: 89,
                    metalCans: 3456,
                    glassBottles: 15670,
                    whiteBlow: 890,
                    opaqueBlow: 567,
                    mixedPlastics: 3456,
                    brittlePlastics: 123,
                    blackPlastics: 789,
                    compressedBottles: 7890,
                    aluminumCans: 234,
                    stainless202: 12,
                    jip: 5,
                    aluminum: 23,
                    batteries: 8,
                    crates: 12,
                    beerCrates: 8,
                    usedOil: 6,
                    carTires: 2
                }
            ]
        };

        function initializeDashboard() {
            updateCurrentDate();
            renderTable();
            updateStats(recycledItemsData.sampleData);
        }

        function updateCurrentDate() {
            const today = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            document.getElementById('currentDate').textContent = today.toLocaleDateString('th-TH', options);
        }

        function renderTable(filteredData = null) {
            const tableContent = document.getElementById('tableContent');
            const dataToRender = filteredData || recycledItemsData.sampleData;
            
            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            ${recycledItemsData.headers.map(header => `<th>${header}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
            `;

            // Add data rows
            dataToRender.forEach(row => {
                tableHTML += `
                    <tr>
                        <td>${row.date}</td>
                        <td>${row.customer}</td>
                        <td class="number-cell">${row.plasticBags.toLocaleString()}</td>
                        <td class="number-cell">${row.sacks.toLocaleString()}</td>
                        <td class="number-cell">${row.ironSteel.toLocaleString()}</td>
                        <td class="number-cell">${row.metalDrums.toLocaleString()}</td>
                        <td class="number-cell">${row.metalCans.toLocaleString()}</td>
                        <td class="number-cell">${row.glassBottles.toLocaleString()}</td>
                        <td class="number-cell">${row.whiteBlow.toLocaleString()}</td>
                        <td class="number-cell">${row.opaqueBlow.toLocaleString()}</td>
                        <td class="number-cell">${row.mixedPlastics.toLocaleString()}</td>
                        <td class="number-cell">${row.brittlePlastics.toLocaleString()}</td>
                        <td class="number-cell">${row.blackPlastics.toLocaleString()}</td>
                        <td class="number-cell">${row.compressedBottles.toLocaleString()}</td>
                        <td class="number-cell">${row.aluminumCans.toLocaleString()}</td>
                        <td class="number-cell">${row.stainless202.toLocaleString()}</td>
                        <td class="number-cell">${row.jip.toLocaleString()}</td>
                        <td class="number-cell">${row.aluminum.toLocaleString()}</td>
                        <td class="number-cell">${row.batteries.toLocaleString()}</td>
                        <td class="number-cell">${row.crates.toLocaleString()}</td>
                        <td class="number-cell">${row.beerCrates.toLocaleString()}</td>
                        <td class="number-cell">${row.usedOil.toLocaleString()}</td>
                        <td class="number-cell">${row.carTires.toLocaleString()}</td>
                    </tr>
                `;
            });

            tableHTML += `
                    </tbody>
                </table>
            `;

            tableContent.innerHTML = tableHTML;
        }

        function calculateTotals() {
            const rows = document.querySelectorAll('tbody tr');
            let totalItems = 0;
            let activeCategories = 0;

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                for (let i = 1; i < cells.length; i++) { // Skip date column
                    const value = parseInt(cells[i].textContent.replace(/,/g, '')) || 0;
                    totalItems += value;
                    if (value > 0) activeCategories++;
                }
            });

            document.getElementById('totalItems').textContent = totalItems.toLocaleString();
            document.getElementById('activeCategories').textContent = activeCategories;
            
            // Estimate revenue (you can adjust pricing)
            const estimatedRevenue = totalItems * 0.5; // ฿0.50 per item average
            document.getElementById('totalRevenue').textContent = `฿${estimatedRevenue.toLocaleString()}`;
        }

        function addNewRow() {
            const today = new Date().toISOString().split('T')[0];
            const newRow = {
                date: today,
                plasticBags: 0,
                sacks: 0,
                ironSteel: 0,
                metalDrums: 0,
                metalCans: 0,
                glassBottles: 0,
                whiteBlow: 0,
                opaqueBlow: 0,
                mixedPlastics: 0,
                brittlePlastics: 0,
                blackPlastics: 0,
                compressedBottles: 0,
                aluminumCans: 0,
                stainless202: 0,
                jip: 0,
                aluminum: 0,
                batteries: 0,
                crates: 0,
                beerCrates: 0,
                usedOil: 0,
                carTires: 0
            };
            
            recycledItemsData.sampleData.unshift(newRow);
            renderTable();
            calculateTotals();
        }

        function filterData() {
            const monthFilter = document.getElementById('monthFilter').value;
            const customerFilter = document.getElementById('customerFilter').value;
            
            let filteredData = recycledItemsData.sampleData;
            
            // Filter by month
            if (monthFilter) {
                filteredData = filteredData.filter(row => {
                    const rowMonth = row.date.split('-')[1]; // Extract month from YYYY-MM-DD
                    return rowMonth === monthFilter;
                });
            }
            
            // Filter by customer
            if (customerFilter) {
                filteredData = filteredData.filter(row => {
                    return row.customer === customerFilter;
                });
            }
            
            // Render filtered table
            renderTable(filteredData);
            
            // Update stats with filtered data
            updateStats(filteredData);
            
            // Show filter status
            showFilterStatus(monthFilter, customerFilter, filteredData.length);
        }
        
        function clearFilters() {
            document.getElementById('monthFilter').value = '';
            document.getElementById('customerFilter').value = '';
            renderTable();
            updateStats(recycledItemsData.sampleData);
            hideFilterStatus();
        }
        
        function updateStats(data) {
            let totalItems = 0;
            let activeCategories = 0;
            
            data.forEach(row => {
                const items = [
                    row.plasticBags, row.sacks, row.ironSteel, row.metalDrums,
                    row.metalCans, row.glassBottles, row.whiteBlow, row.opaqueBlow,
                    row.mixedPlastics, row.brittlePlastics, row.blackPlastics,
                    row.compressedBottles, row.aluminumCans, row.stainless202,
                    row.jip, row.aluminum, row.batteries, row.crates,
                    row.beerCrates, row.usedOil, row.carTires
                ];
                
                items.forEach(item => {
                    totalItems += item;
                    if (item > 0) activeCategories++;
                });
            });
            
            document.getElementById('totalItems').textContent = totalItems.toLocaleString();
            document.getElementById('activeCategories').textContent = activeCategories;
            
            const estimatedRevenue = totalItems * 0.5;
            document.getElementById('totalRevenue').textContent = `฿${estimatedRevenue.toLocaleString()}`;
        }
        
        function showFilterStatus(monthFilter, customerFilter, recordCount) {
            let statusText = '';
            if (monthFilter || customerFilter) {
                statusText = `📊 Showing ${recordCount} records`;
                if (monthFilter) {
                    const monthNames = ['', 'January', 'February', 'March', 'April', 'May', 'June', 
                                      'July', 'August', 'September', 'October', 'November', 'December'];
                    statusText += ` for ${monthNames[parseInt(monthFilter)]}`;
                }
                if (customerFilter) {
                    statusText += ` from ${customerFilter}`;
                }
            }
            
            // Update or create status element
            let statusElement = document.getElementById('filterStatus');
            if (!statusElement) {
                statusElement = document.createElement('div');
                statusElement.id = 'filterStatus';
                statusElement.className = 'filter-status';
                document.querySelector('.filter-section').appendChild(statusElement);
            }
            statusElement.textContent = statusText;
        }
        
        function hideFilterStatus() {
            const statusElement = document.getElementById('filterStatus');
            if (statusElement) {
                statusElement.remove();
            }
        }

        // Modal and Form Functions
        function openAddEntryModal() {
            const modal = document.getElementById('addEntryModal');
            modal.style.display = 'block';
            
            // Set default date to today
            const today = new Date();
            const dateString = today.toISOString().slice(0, 16);
            document.getElementById('entryDate').value = dateString;
            
            // Clear previous selections
            document.getElementById('entryCustomer').value = '';
            clearFormInputs();
        }

        function closeAddEntryModal() {
            const modal = document.getElementById('addEntryModal');
            modal.style.display = 'none';
        }

        function clearFormInputs() {
            // Clear all number inputs in the table
            const inputs = document.querySelectorAll('.items-table input[type="number"]');
            inputs.forEach(input => {
                input.value = '';
            });
        }

        function submitEntry() {
            const date = document.getElementById('entryDate').value;
            const customer = document.getElementById('entryCustomer').value;
            
            if (!date || !customer) {
                alert('Please fill in both date and customer fields.');
                return;
            }
            
            // Collect form data
            const formData = {
                date: date.split('T')[0], // Convert datetime-local to date only
                customer: customer
            };
            
            // Add all item quantities from the table inputs
            const allItems = [
                'plasticBags', 'sacks', 'ironSteel', 'metalDrums', 'metalCans',
                'glassBottles', 'whiteBlow', 'opaqueBlow', 'mixedPlastics',
                'brittlePlastics', 'blackPlastics', 'compressedBottles',
                'aluminumCans', 'stainless202', 'jip', 'aluminum', 'batteries',
                'crates', 'beerCrates', 'usedOil', 'carTires'
            ];
            
            allItems.forEach(item => {
                const input = document.getElementById(item);
                formData[item] = input ? parseInt(input.value) || 0 : 0;
            });
            
            // Add to data
            recycledItemsData.sampleData.unshift(formData);
            
            // Update table and stats
            renderTable();
            updateStats(recycledItemsData.sampleData);
            
            // Close modal
            closeAddEntryModal();
            
            // Show success message
            showSuccessMessage('Entry added successfully!');
        }

        function showSuccessMessage(message) {
            // Create temporary success message
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                z-index: 1001;
                font-weight: 600;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            `;
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            // Remove after 3 seconds
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('addEntryModal');
            if (event.target === modal) {
                closeAddEntryModal();
            }
        }

        function exportToExcel() {
            alert('Export functionality will be implemented with backend integration');
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
</body>
</html>
